public with sharing class SBR_3_0_CartDA implements SBR_3_0_CartDAI {
    public static  Cart__c getCart (String recordId) {
        System.debug('recordId->'+recordId);
        List<Cart__c> carts = new List<Cart__c>();
        carts = [
                   SELECT 
                    Owner.Name,
                    Owner.Email,
                    Owner.Phone,
                    Id,
                    Name,
                    CurrencyIsoCode,
                    CreatedDate,
        City__c,
        User_Branch_is_Cart_Branch__c,
                    User_Location_Branch__c,
                    State__c,
                    Street__c,
                    Zip_Code__c,
                    Customer_Pick_Up__c,
                    Is_Active__c,
                    Notes__c,
                    AFE_PO__c,
                    Rental_Period__c,
                    Nearest_City__c,
                    Order_Notes__c,
                    POJ_Cleaning_Schedule__c,
                    POJ_Scheduling_Other__c,
                    Status__c,
                    Contract_Order_Number__c,
                    Email__c,
                    Total__c,
                    Assigned_To_Local_Branch__c,
                    Account_Company_Code__c,
                    Company_Code__c,
                    Rental_End_Date__c,
                    Rental_Start_Date__c,
                    Assign_Cart_Permission__c,
                    Directions__c,
                    Directive__c,
                    Existing_Job_Site__c,
                    Fueling_Schedule_Other__c,
                    Fueling_Schedule__c,
                    Job_Location__c,
                    Job_Name__c,
                    LastModifiedDate,
                    Account__r.Id,
                    Account__r.Name,
                    Account__r.Type,
                    Account__r.BillingStreet,
                    Account__r.BillingCity,
                    Account__r.BillingState,
                    Account__r.BillingPostalCode,
                    Account__r.BillingCountry,
                    Account__r.BillingStateCode,
                    Account__r.BillingCountryCode,
                    Account__r.BillingLatitude,
                    Account__r.BillingLongitude,
                    Account__r.BillingGeocodeAccuracy,
                    Account__r.BillingAddress,
                    Account__r.ShippingStreet,
                    Account__r.ShippingCity,
                    Account__r.ShippingState,
                    Account__r.ShippingPostalCode,
                    Account__r.ShippingCountry,
                    Account__r.ShippingStateCode,
                    Account__r.ShippingCountryCode,
                    Account__r.ShippingLatitude,
                    Account__r.ShippingLongitude,
                    Account__r.ShippingGeocodeAccuracy,
                    Account__r.ShippingAddress,
                    Account__r.Phone,
                    Account__r.Fax,
                    Account__r.AccountNumber,
                    Account__r.SBQQ__AssetQuantitiesCombined__c,
                    Account__r.SBQQ__CoTermedContractsCombined__c,
                    Account__r.SBQQ__CoTerminationEvent__c,
                    Account__r.SBQQ__ContractCoTermination__c,
                    Account__r.SBQQ__DefaultOpportunity__c,
                    Account__r.SBQQ__IgnoreParentContractedPrices__c,
                    Account__r.SBQQ__PreserveBundle__c,
                    Account__r.SBQQ__PriceHoldEnd__c,
                    Account__r.SBQQ__RenewalModel__c,
                    Account__r.SBQQ__RenewalPricingMethod__c,
                    Account__r.SBQQ__TaxExempt__c,
                    Account__r.Bill_for_Pickup__c,
                    Account__r.Billing_Code_Description__c,
                    Account__r.Billing_Code__c,
                    Account__r.Branch_Location_Name__c,
                    Account__r.Branch_Location_Number__c,
                    Account__r.Business_Entity_Desc__c,
                    Account__r.Billing_Street1__c,
                    Account__r.Rental_Opportunity__c,
                    Account__r.Charge_Tax__c,
                    Account__r.Charge_Tax_on_Rentals__c,
                    Account__r.Charge_for_RPP__c,
                    Account__r.Class_Description__c,
                    Account__r.Description_Comment_2__c,
                    Account__r.Comments__c,
                    Account__r.Company_Code__c,
                    Account__r.Company_Name__c,
                    Account__r.Contract_Type_Description__c,
                    Account__r.Country_Code_Description__c,
                    Account__r.Credit_Code_Description__c,
                    Account__r.Status__c,
                    Account__r.Strategic_Type__c,
                    Account__r.Subtract_Sat_Sun_After_Cycle__c,
                    Account__r.Subtract_Saturday_from_Billing__c,
                    Account__r.Subtract_Sunday_from_Billing__c,
                    Account__r.Tax_Exempt_Code__c,
                    Account__r.Tax_Exempt_Description__c,
                    Account__r.Tax_Sales_Exempt_Code__c,
                    Account__r.Tax_Sales__c,
                    Account__r.Term_Days_Rental__c,
                    Account__r.Term_Days_Sales__c,
                    Account__r.Territory_Number__c,
                    Account__r.Total_Revenue_Amount__c,
                    Account__r.Monthly_Rental_Discount__c,
                    Account__r.Weekly_Rental_Discount__c,
                    Account__r.Calculate_Late_Charge__c,
                    Account__r.Dun_Bradstreet_Rating__c,
                    Account__r.Billing_Street2__c,
                    Account__r.Shipping_Street1__c,
                    Account__r.Vendor_Account_Number__c,
                    Account__r.Strategy_Last_Updated__c,
                    Account__r.Unique_Preferences_Hot_Buttons__c,
                    Account__r.Override_Address_LatLong_error__c,
                    Account__r.Street_Address_LatLong_Status__c,
                    Account__r.Street_Address_LatLong__Latitude__s,
                    Account__r.Street_Address_LatLong__Longitude__s,
                    Account__r.Street_Address_LatLong__c,
                    Account__r.Street_Address_LatLong_error__c,
                    Account__r.Second_Id_Expiration_Date__c,
                    Account__r.Date_of_Birth__c,
                    Account__r.BirthDate__c,
                    Account__r.Preferred_method_of_Contact__c,
                    Branch__r.Id,
                    Branch__r.OwnerId,
                    Branch__r.Name,
                    Branch__r.Charge_Environmental_Fee__c,
                    Branch__r.City__c,
                    Branch__r.Company_Code__c,
                    Branch__r.Branch_Location_Number__c,                    
                    Branch__r.Company_Name__c,
                    Branch__r.Company_Project_Number__c,
                    Branch__r.Contact_Name__c,
                    Branch__r.Contract_Number__c,
                    Branch__r.Contract_Price_Number__c,
                    Branch__r.Cost_at_company__c,
                    Branch__r.County_Code__c,
                    Branch__r.County__c,
                    Branch__r.Company_ID__c,
                    Branch__r.Company__c,
                    Branch__r.Branch_Email__c,
                    Branch__r.Analysis_Region2__c,
                    Branch__r.Address__c,
                    Contact__r.Id,
                    Contact__r.MasterRecordId,
                    Contact__r.AccountId,
                    Contact__r.LastName,
                    Contact__r.FirstName,
                    Contact__r.Salutation,
                    Contact__r.MiddleName,
                    Contact__r.Suffix,
                    Contact__r.Name,
                    Contact__r.MailingStreet,
                    Contact__r.MailingCity,
                    Contact__r.MailingState,
                    Contact__r.MailingPostalCode,
                    Contact__r.MailingCountry,
                    Contact__r.MailingStateCode,
                    Contact__r.MailingCountryCode,
                    Contact__r.MailingLatitude,
                    Contact__r.MailingLongitude,
                    Contact__r.MailingGeocodeAccuracy,
                    Contact__r.MailingAddress,
                    Contact__r.Phone,
                    Contact__r.Fax,
                    Contact__r.MobilePhone,
                    Contact__r.AssistantPhone,
                    Contact__r.ReportsToId,
                    Contact__r.Email,
                    Contact__r.Title,
                    Contact__r.Department,
                    Contact__r.Status__c,
                    Contact__r.First_Name__c,
                    Contact__r.Last_Name__c,
                    Contact__r.Salutation__c,
                    Contact__r.Suffix__c,
                    Contact__r.Account_Number__c,
                    Contact__r.Account_Record_Type__c,
                    Contact__r.Role__c,
                    User_Location__r.Id,
                    User_Location__r.OwnerId,
                    User_Location__r.Name,
                    User_Location__r.CurrencyIsoCode,
                    Job_Site__r.Id,
                    Job_Site__r.AssociatedLocationNumber,
                    Job_Site__r.CurrencyIsoCode,
                    Job_Site__r.Type,
                    Job_Site__r.ActiveFrom,
                    Job_Site__r.ActiveTo,
                    Job_Site__r.Branch__c,
                    Job_Site__r.City__c,
                    Job_Site__r.JobsiteName__c,
                    Job_Site__r.Latitude_Longitude__Latitude__s,
                    Job_Site__r.Latitude_Longitude__Longitude__s,
                    Job_Site__r.Latitude_Longitude__c,
                    Job_Site__r.Street_Address__c,
                    Job_Site__r.Zip_Code__c,
                    Job_Site__r.Address_Validation_Status__c,
                    Job_Site__r.Source_Of_Update__c,
                    Job_Site__r.State__c,
                    Job_Site__r.Account_Number__c,
                    Job_Site__r.Associated_Location_Id__c,
                    //Job_Site__r.Auto_Fax_Email__c, //SF-7018
                    Job_Site__r.Billing_Code_Description__c,
                    Job_Site__r.Street_Address_2__c,
                    Job_Site__r.Company_Code__c,
                    Job_Site__r.Company_Project_Number__c,
                    Job_Site__r.Contact_Name__c,
                    Job_Site__r.Contact_Person__c,
                    Job_Site__r.Contract_Price_Number__c,
                    Job_Site__r.County_Code__c,
                    Job_Site__r.County__c,
                    Job_Site__r.Name__c,
                    Job_Site__r.Status__c,
        (
          SELECT
            Id,
                    Name,
                    CurrencyIsoCode,
                    Cart__c,
                    Cat_Class__c,
                    Daily_Price__c,
                    Description__c,
                    Extended_Amount__c,
                    Hourly_Price__c,
                    Monthly_Price__c,
                    Product__c,
                    Quantity__c,
                    Weekly_Price__c,
                    Book_Daily_Price__c,
                    Book_Minimum_Price__c,
                    Book_Monthly_Price__c,
                    Book_Weekly_Price__c,
                    Floor_Daily_Price__c,
                    Floor_Minimum_Price__c,
                    Floor_Monthly_Price__c,
                    Floor_Weekly_Price__c,
                    Suggested_Daily_Price__c,
                    Suggested_Minimum_Price__c,
                    Suggested_Monthly_Price__c,
                    Suggested_Weekly_Price__c,
                    Target_Daily_Price__c,
                    Target_Minimum_Price__c,
                    Target_Monthly_Price__c,
                    Target_Weekly_Price__c,
                    Item_Subtotal__c,
                    Minimum_Price__c,
            Misc_Sales_Price__c
          FROM Cart_Items__r
        ),
        (
          SELECT
            Id,
                    Name,
                    CurrencyIsoCode,
                    Cart__c,
                    Description__c,
                    Freight__c,
                    Meters__c,
                    Notes__c,
                    Start_Date__c,
            Unit__c
          FROM Order_Form_Items__r
        ),
        (
          SELECT
            Id,
                    OwnerId,
                    Name,
                    SBQQ__Account__c,
                    SBQQ__AdditionalDiscountAmount__c,
                    SBQQ__AverageCustomerDiscount__c,
                    SBQQ__AveragePartnerDiscount__c,
                    SBQQ__BillingCity__c,
                    SBQQ__BillingCountry__c,
                    SBQQ__BillingFrequency__c,
                    SBQQ__BillingName__c,
                    SBQQ__BillingPostalCode__c,
                    SBQQ__BillingState__c,
                    SBQQ__BillingStreet__c,
                    SBQQ__ConsumptionRateOverride__c,
                    SBQQ__ContractingMethod__c,
                    SBQQ__DocumentStatus__c,
                    SBQQ__EmailTemplateId__c,
                    SBQQ__EndDate__c,
                    Jobsite__c,
                    Source_Of_Update__c,
                    Secondary_Rep__c,
                    Campaign__c,
                    Total_Estimated_Revenue__c,
                    SBQQ_Last_Line_Update__c,
                    GST_Tax__c,
                    Job_Location__c,
                    Job_Number__c,
                    Quote_Name__c,
                    Duration__c,
                    Estimated_Return_Date__c,
                    Job_Site_Branch__c,
                    Job_Site_Contact__c,
                    Project__c,
                    Shared_Location__c,
                    Territory_Number__c,
                    End_Date__c,
                    External_Notes__c,
                    Internal_Notes__c,
                    Quote_Discount__c,
                    Quote_Type__c,
                    Scaffold_Rental_Type__c,
                    Start_Date__c,
                    QuoteDiscount__c,
                    Total_Contingency_Cost__c,
                    Branch_Email__c,
                    Company_Code__c
          FROM Quotes__r
        )
                FROM Cart__c 
                WHERE Id=:recordId
            ];
        if(!carts.isEmpty()){
            return carts[0];
        }
        return null;
    }
}