public with sharing class SBR_3_0_OrderLineDA implements SBR_3_0_OrderLineDAI {
  public static List<OrderItem> getOrderItems(String orderId) {
    return [
      SELECT
        Id,
        Product2.Name,
        Fuel_Plan__c,
        Kit_Number_This_Item_Belongs_To__c,
        Apply_Standby_Rates__c,
        Contingency_Cost__c,
        Daily_Rate__c,
        Line_Comments__c,
        Line_Item_Notes__c,
        Min_Rate__c,
        Monthly_Rate__c,
        OrderId,
        Seasonal_Multiplier__c,
        Shift_Differential__c,
        Weekly_Rate__c,
        Override_Discount__c,
        Quantity,
        SBQQ__OrderedQuantity__c,
        Daily_Rate2__c,
        Weekly_Rate2__c,
        Monthly_Rate2__c,
        Selling_Price__c
      FROM OrderItem
      WHERE OrderId = :orderId
    ];
  }
  //SF-5291,SF-5292 include Fuel_Plan__c, 	Kit_Number_This_Item_Belongs_To__c fields
  public static List<OrderItem> getOrderItems(String orderId, String groupId) {
    //todo: update once group id field is determined
    if (groupId != null && !String.isBlank(groupId)) {
      return [
        SELECT
          Id,
          Product2.Name,
          Fuel_Plan__c,
          Kit_Number_This_Item_Belongs_To__c,
          Apply_Standby_Rates__c,
          Contingency_Cost__c,
          Daily_Rate__c,
          Line_Comments__c,
          Line_Item_Notes__c,
          Min_Rate__c,
          Selling_Price__c,
          Monthly_Rate__c,
          OrderId,
          Seasonal_Multiplier__c,
          Shift_Differential__c,
          Weekly_Rate__c,
          groupID__c,
          Quantity,
          Rates_Branch__c,
          Order.Branch__r.Branch_Location_Name__c,
          Order.Branch__r.Branch_Location_Number__c,
          Specific_Pricing_Type__c,
          Specific_Pricing_Flag__c,
          Suggested_Daily_Rate__c,
          Suggested_Minimum_Rate__c,
          Suggested_Monthly_Rate__c,
          Suggested_Weekly_Rate__c,
          Order.Branch__r.Latitude_Longitude__Latitude__s,
          Order.Branch__r.Latitude_Longitude__Longitude__s,
          Order.Branch__r.Time_Zone_Id__c,
          Order.RM_Account_Number__c,
          Order.Start_Date__c,
          Order.Return_Date__c,
          Order.Jobsite__r.Street_Address__c,
          Order.Jobsite__r.City__c,
          Order.Jobsite__r.State__c,
          Order.Jobsite__r.Zip_Code__c,
          Order.Order_Discount__c,
          Product2.Bulk_Item__c,
          Order.Jobsite__r.Latitude_Longitude__Latitude__s,
          Order.Jobsite__r.Latitude_Longitude__Longitude__s,
          Product2.Category__c,
          Product2.Class__c,
          Product2.Product_SKU__c,
          Override_Discount__c,
          SBQQ__OrderedQuantity__c,
          Order.Submitted_to_Wynne__c,
          Order.Reservation_Order_Number__c,
          Daily_Rate2__c,
          Weekly_Rate2__c,
          Monthly_Rate2__c,
          Product2.Product_Type__c,
          Order.Status,
		  Discount_Percentage__c
        FROM OrderItem
        WHERE OrderId = :orderId AND groupID__c = :groupId
      ];
    }
    System.debug('groupe does not exist ...');
    System.debug('orderId = ' + orderId);
    return [
      SELECT
        Id,
        Product2.Name,
        Apply_Standby_Rates__c,
        Fuel_Plan__c,
        Kit_Number_This_Item_Belongs_To__c,
        Contingency_Cost__c,
        Daily_Rate__c,
        Line_Comments__c,
        Line_Item_Notes__c,
        Min_Rate__c,
        Selling_Price__c,
        Monthly_Rate__c,
        OrderId,
        Seasonal_Multiplier__c,
        Shift_Differential__c,
        Weekly_Rate__c,
        groupID__c,
        Quantity,
        Order.Branch__r.Branch_Location_Name__c,
        Order.Branch__r.Branch_Location_Number__c,
        Specific_Pricing_Type__c,
        Specific_Pricing_Flag__c,
        Suggested_Daily_Rate__c,
        Suggested_Minimum_Rate__c,
        Suggested_Monthly_Rate__c,
        Suggested_Weekly_Rate__c,
        Order.Branch__r.Latitude_Longitude__Latitude__s,
        Order.Branch__r.Latitude_Longitude__Longitude__s,
        Order.Branch__r.Time_Zone_Id__c,
        Order.RM_Account_Number__c,
        Order.Start_Date__c,
        Order.Return_Date__c,
        Order.Jobsite__r.Street_Address__c,
        Order.Jobsite__r.City__c,
        Order.Jobsite__r.State__c,
        Order.Jobsite__r.Zip_Code__c,
        Order.Order_Discount__c,
        Product2.Bulk_Item__c,
        Order.Jobsite__r.Latitude_Longitude__Latitude__s,
        Order.Jobsite__r.Latitude_Longitude__Longitude__s,
        Product2.Category__c,
        Product2.Class__c,
        Product2.Product_SKU__c,
        Override_Discount__c,
        SBQQ__OrderedQuantity__c,
        Order.Submitted_to_Wynne__c,
        Order.Reservation_Order_Number__c,
        Daily_Rate2__c,
        Weekly_Rate2__c,
        Monthly_Rate2__c,
        Product2.Product_Type__c,
        Order.Status
      FROM OrderItem
      WHERE OrderId = :orderId
    ];
  }

  public static List<OrderItem> getOrderItems(Set<Id> orderIds) {
    //todo: update once group id field is determined
    return [
      SELECT
        Id,
        Product2.Name,
        Apply_Standby_Rates__c,
        Fuel_Plan__c,
        Kit_Number_This_Item_Belongs_To__c,
        Contingency_Cost__c,
        Daily_Rate__c,
        Line_Comments__c,
        Line_Item_Notes__c,
        Min_Rate__c,
        Monthly_Rate__c,
        OrderId,
        Seasonal_Multiplier__c,
        Shift_Differential__c,
        Weekly_Rate__c,
        groupID__c,
        Quantity,
        Order.Branch__r.Branch_Location_Name__c,
        Order.Branch__r.Branch_Location_Number__c,
        Specific_Pricing_Type__c,
        Specific_Pricing_Flag__c,
        Suggested_Daily_Rate__c,
        Suggested_Minimum_Rate__c,
        Suggested_Monthly_Rate__c,
        Suggested_Weekly_Rate__c,
        Order.Branch__r.Latitude_Longitude__Latitude__s,
        Order.Branch__r.Latitude_Longitude__Longitude__s,
        Order.Branch__r.Time_Zone_Id__c,
        Order.RM_Account_Number__c,
        Order.Start_Date__c,
        Order.Return_Date__c,
        Order.Jobsite__r.Street_Address__c,
        Order.Jobsite__r.City__c,
        Order.Jobsite__r.State__c,
        Order.Jobsite__r.Zip_Code__c,
        Order.Jobsite__r.Latitude_Longitude__Latitude__s,
        Order.Jobsite__r.Latitude_Longitude__Longitude__s,
        Product2.Category__c,
        Product2.Class__c,
        Product2.Product_SKU__c,
        Override_Discount__c,
        SBQQ__OrderedQuantity__c,
        Daily_Rate2__c,
        Weekly_Rate2__c,
        Monthly_Rate2__c,
        Selling_Price__c,
        Order.Order_Discount__c,
        Product2.Bulk_Item__c,
        Order.Submitted_to_Wynne__c,
        Order.Reservation_Order_Number__c,
        Product2.Product_Type__c,
        Order.Status
      FROM OrderItem
      WHERE OrderId IN :orderIds
    ];
  }
}